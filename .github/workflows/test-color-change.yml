name: Test Color Change PR

on:
  workflow_dispatch: # rƒôczne uruchomienie z GitHub Actions

jobs:
  create-test-pr:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repo
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: Set up Git
        run: |
          git config user.name "ChatGPT Codex Bot"
          git config user.email "bot@openai.com"

      - name: Prepare branch
        run: |
          BRANCH="feature/test-color-change"
          if git show-ref --verify --quiet refs/heads/$BRANCH; then
            echo "üîÅ Branch $BRANCH already exists. Switching..."
            git checkout $BRANCH
          else
            echo "‚ú® Creating new branch $BRANCH..."
            git checkout -b $BRANCH
          fi

      - name: Modify landing page background color
        run: |
          FILE="app/page.tsx"
          if [ ! -f "$FILE" ]; then
            echo "‚ùå File $FILE not found!"
            exit 1
          fi

          echo "üîç Checking for existing background color..."
          if grep -q "bg-[#faf7f3]" "$FILE"; then
            sed -i 's/bg-[#faf7f3]/bg-[#f4ede4]/g' "$FILE"
            echo "‚úÖ Color updated (faf7f3 ‚Üí f4ede4)"
          else
            echo "‚ö†Ô∏è Color not found or already updated. Skipping replacement."
          fi

      - name: Commit and push changes
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        run: |
          git add app/page.tsx || true
          git commit -m "test: change background color of landing page" || echo "No changes to commit"
          git push origin feature/test-color-change --force

      - name: Create Pull Request
        uses: peter-evans/create-pull-request@v6
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
          title: "Test: change background color of landing page"
          body: |
            ‚úÖ Automatyczna testowa zmiana koloru t≈Ça strony g≈Ç√≥wnej (`bg-[#faf7f3]` ‚Üí `bg-[#f4ede4]`)

            Utworzono przez GitHub Actions w celu potwierdzenia poprawnego po≈ÇƒÖczenia ChatGPT Codex Connector.
          branch: feature/test-color-change
          base: main
          labels: |
            automation
            chatgpt
